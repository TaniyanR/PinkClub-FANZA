<?php declare(strict_types=1);

require_once __DIR__ . '/_bootstrap.php'; require_once __DIR__ . '/../lib/app_features.php'; require_once __DIR__ . '/../lib/csrf.php'; require_once __DIR__ . '/partials/_helpers.php'; function e2(string $v): string { return htmlspecialchars($v, ENT_QUOTES | ENT_SUBSTITUTE | ENT_HTML5, 'UTF-8'); } $err=''; if(($_SERVER['REQUEST_METHOD']??'GET')==='POST'){ if(!csrf_verify((string)($_POST['_token']??''))){$err='CSRFエラー';} elseif(!user_login(trim((string)$_POST['email']),(string)$_POST['password'])){$err='ログイン失敗';} else { header('Location: /index.php'); exit; }} $pageTitle='会員ログイン'; include __DIR__.'/partials/header.php'; ?><div class="site-body"><main class="main-content"><section class="block"><h1>会員ログイン</h1><?php if($err!==''): ?><p><?php echo e2($err); ?></p><?php endif; ?><form method="post"><input type="hidden" name="_token" value="<?php echo e2(csrf_token()); ?>"><input type="email" name="email" required><input type="password" name="password" required><button>ログイン</button></form><p><a href="/user_register.php">新規登録</a></p></section></main></div><?php include __DIR__.'/partials/footer.php';
